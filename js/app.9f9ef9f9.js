(function(){"use strict";var e={3848:function(e,t,n){var i=n(9242),l=n(3396);const r=(0,l._)("h1",null,"Simple mail client",-1),a=(0,l.Uk)(" Loading... ");function o(e,t,n,i,o,c){const s=(0,l.up)("mail-table");return(0,l.wg)(),(0,l.iD)(l.HY,null,[r,((0,l.wg)(),(0,l.j4)(l.n4,null,{default:(0,l.w5)((()=>[(0,l.Wm)(s)])),fallback:(0,l.w5)((()=>[a])),_:1}))],64)}var c=n(7139);const s=["disabled"],u=["disabled"],d={class:"mail-table"},m=["onClick","checked"],f=["onClick"],p=["onClick"],v=["onClick"],b=["onClick"],h={key:1};function k(e,t,n,i,r,a){const o=(0,l.up)("bulk-action-bar"),k=(0,l.up)("mail-view"),g=(0,l.up)("modal-view");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l._)("button",{onClick:t[0]||(t[0]=e=>a.selectScreen("inbox")),disabled:"inbox"==i.selectedScreen,class:(0,c.C_)("inbox"==i.selectedScreen?"orange":"")},"Inbox",10,s),(0,l._)("button",{onClick:t[1]||(t[1]=e=>a.selectScreen("archive")),disabled:"archive"==i.selectedScreen,class:(0,c.C_)("archive"==i.selectedScreen?"orange":"")},"Archived",10,u),a.filteredEmails.length>0?((0,l.wg)(),(0,l.iD)(l.HY,{key:0},[(0,l.Wm)(o,{emails:a.filteredEmails,selectedScreen:i.selectedScreen},null,8,["emails","selectedScreen"]),(0,l._)("div",null,[(0,l._)("table",d,[(0,l._)("tbody",null,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(a.filteredEmails,(e=>((0,l.wg)(),(0,l.iD)("tr",{key:e.id,class:(0,c.C_)(["clickable",e.read?"":"read"])},[(0,l._)("td",null,[(0,l._)("input",{type:"checkbox",onClick:t=>i.emailSelection.toggle(e),checked:i.emailSelection.emails.has(e)},null,8,m)]),(0,l._)("td",{onClick:t=>a.openEmail(e),style:{"min-width":"170px"}},(0,c.zw)(e.from),9,f),(0,l._)("td",{onClick:t=>a.openEmail(e)},[(0,l._)("p",null,[(0,l._)("span",{class:(0,c.C_)([e.read?"":"title"])},(0,c.zw)(e.subject),3),(0,l.Uk)(" - "+(0,c.zw)(e.body),1)])],8,p),(0,l._)("td",{class:"date",onClick:t=>a.openEmail(e)},(0,c.zw)(i.format(new Date(e.sentAt),"MMM do yyyy")),9,v),(0,l._)("td",null,[(0,l._)("button",{onClick:t=>a.archiveEmail(e)},(0,c.zw)("inbox"==i.selectedScreen?"Archive":"Restore"),9,b)])],2)))),128))])]),i.openedEmail?((0,l.wg)(),(0,l.j4)(g,{key:0,onCloseModal:t[2]||(t[2]=e=>i.openedEmail=null)},{default:(0,l.w5)((()=>[(0,l.Wm)(k,{email:i.openedEmail,onChangeEmail:a.changeEmail},null,8,["email","onChangeEmail"])])),_:1})):(0,l.kq)("",!0)])],64)):((0,l.wg)(),(0,l.iD)("h1",h,"Писем нет"))],64)}var g=n(737);const y={class:"email-display"},w={class:"mb-0"},_=(0,l.Uk)("Subject: "),S=["innerHTML"];function E(e,t,n,i,r,a){return(0,l.wg)(),(0,l.iD)("div",y,[(0,l._)("div",null,[(0,l._)("button",{onClick:t[0]||(t[0]=(...e)=>i.toggleArchive&&i.toggleArchive(...e))},(0,c.zw)(n.email.archived?"Move to Inbox (e)":"Archive (e)"),1),(0,l._)("button",{onClick:t[1]||(t[1]=(...e)=>i.toggleRead&&i.toggleRead(...e))},(0,c.zw)(n.email.read?"Mark Unread (r)":"Mark Read (r)"),1),(0,l._)("button",{onClick:t[2]||(t[2]=(...e)=>i.togglePrev&&i.togglePrev(...e))},"Prev (j)"),(0,l._)("button",{onClick:t[3]||(t[3]=(...e)=>i.toggleNext&&i.toggleNext(...e))},"Next (k)")]),(0,l._)("h2",w,[_,(0,l._)("strong",null,(0,c.zw)(n.email.subject),1)]),(0,l._)("div",null,[(0,l._)("em",null,"From "+(0,c.zw)(n.email.from)+" on "+(0,c.zw)(i.format(new Date(n.email.sentAt),"MMM do yyyy")),1)]),(0,l._)("div",{innerHTML:i.marked(n.email.body)},null,8,S)])}var C=n(5068);let j=e=>{let t=t=>{let n=e.find((e=>e.key==t.key));n&&n.fn()};window.addEventListener("keydown",t),(0,l.Jd)((()=>{window.removeEventListener("keydown",t)}))};var x=j,M={setup(e,{emit:t}){let n=e.email;n.body=n.body.replaceAll("\\n","\n");let i=()=>{t("changeEmail",{changeIndex:1})},l=()=>{t("changeEmail",{changeIndex:-1})},r=async()=>{n.read=!n.read;const{error:e}=await supabase.from("emails").update(n).eq("id",n.id)},a=async()=>{n.archived=!n.archived;const{error:e}=await supabase.from("emails").update(n).eq("id",n.id)};return x([{key:"r",fn:r},{key:"к",fn:r},{key:"e",fn:a},{key:"k",fn:i},{key:"j",fn:l}]),{format:g.Z,marked:C.TU,toggleRead:r,toggleArchive:a,toggleNext:i,togglePrev:l}},props:{email:{type:Object,required:!0}}},O=n(89);const I=(0,O.Z)(M,[["render",E]]);var A=I;const z={class:"modal"},D={class:"modal-card"};function T(e,t,n,i,r,a){return(0,l.wg)(),(0,l.iD)("div",z,[(0,l._)("div",{class:"overlay",onClick:t[0]||(t[0]=e=>i.emit("closeModal"))}),(0,l._)("div",D,[(0,l.WI)(e.$slots,"default")])])}var q={setup(e,{emit:t}){return x([{key:"Escape",fn:()=>{t("closeModal")}}]),{emit:t}}};const H=(0,O.Z)(q,[["render",T]]);var P=H;const N={class:"bulk-action-bar"},R={class:"ckeckbox"},Z=["checked"],Y={class:"buttons"},F=["disabled"],J=["disabled"],U=["disabled"];function L(e,t,n,i,r,a){return(0,l.wg)(),(0,l.iD)("div",N,[(0,l._)("span",R,[(0,l._)("input",{type:"checkbox",onClick:t[0]||(t[0]=(...e)=>i.bulkSelect&&i.bulkSelect(...e)),checked:i.allEmailsSelected,class:(0,c.C_)([i.someEmailsSelected?"partial-check":""])},null,10,Z),i.emailSelection.emails.size?((0,l.wg)(),(0,l.iD)("span",{key:0,class:"checkbox_count",onClick:t[1]||(t[1]=(...e)=>i.bulkSelect&&i.bulkSelect(...e))},(0,c.zw)(i.emailSelection.emails.size),1)):(0,l.kq)("",!0),(0,l._)("span",Y,[(0,l._)("button",{onClick:t[2]||(t[2]=e=>i.emailSelection.markRead()),disabled:[...i.emailSelection.emails].every((e=>e.read))},"Mark Read",8,F),(0,l._)("button",{onClick:t[3]||(t[3]=e=>i.emailSelection.markUnread()),disabled:[...i.emailSelection.emails].every((e=>!e.read))},"Mark Unread",8,J),(0,l._)("button",{onClick:t[4]||(t[4]=e=>i.emailSelection.archive()),disabled:0==i.numberSelected},(0,c.zw)("inbox"==n.selectedScreen?"Archive":"Restore"),9,U)])])])}var X=n(4870),W=n(8577);const B="https://lmmwrqcvrpehtnxolcnk.supabase.co",V="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImxtbXdycWN2cnBlaHRueG9sY25rIiwicm9sZSI6ImFub24iLCJpYXQiOjE2NjM3ODQ2NjgsImV4cCI6MTk3OTM2MDY2OH0.XD5tmdfuGnTYVXf3wJ1e3RWCYHnqeH6XhXZp-6tQwlQ",Q=(0,W.eI)(B,V);let G=(0,X.qj)(new Set);const K=function(){let e=function(e){G.has(e)?G.delete(e):G.add(e)},t=()=>{G.clear()},n=e=>{e.forEach((e=>{G.add(e)}))},i=e=>{G.forEach((async t=>{e(t);const{error:n}=await Q.from("emails").update(t).eq("id",t.id)})),t()},l=()=>i((e=>e.read=!0)),r=()=>i((e=>e.read=!1)),a=()=>i((e=>e.archived=!e.archived));return{emails:G,toggle:e,clear:t,addMultiple:n,markRead:l,markUnread:r,archive:a}};var $=K,ee={setup(e){let t=$(),n=(0,l.Fl)((()=>t.emails.size)),i=(0,l.Fl)((()=>e.emails.length)),r=(0,l.Fl)((()=>n.value===i.value)),a=(0,l.Fl)((()=>n.value>0&&n.value<i.value)),o=function(){r.value?t.clear():t.addMultiple(e.emails)};return{allEmailsSelected:r,someEmailsSelected:a,bulkSelect:o,emailSelection:t,numberSelected:n,numbersEmails:i}},props:{emails:{type:Array,required:!0},selectedScreen:{type:String,required:!0}}};const te=(0,O.Z)(ee,[["render",L]]);var ne=te,ie={components:{MailView:A,ModalView:P,BulkActionBar:ne},async setup(){let{data:e,error:t}=await Q.from("emails").select("*");return{emailSelection:$(),format:g.Z,emails:(0,X.iH)(e),openedEmail:(0,X.iH)(null),selectedScreen:(0,X.iH)("inbox")}},computed:{sortedEmails(){return this.emails.sort(((e,t)=>e.sentAt<t.sentAt?1:-1))},filteredEmails(){return"inbox"==this.selectedScreen?this.sortedEmails.filter((e=>!e.archived)):this.sortedEmails.filter((e=>e.archived))}},methods:{changeEmail({changeIndex:e}){if(e){let t=this.filteredEmails,n=t.indexOf(this.openedEmail),i=n+e>=0&&n+e!=t.length;if(i){let i=t[n+e];this.openEmail(i)}}},selectScreen(e){this.selectedScreen=e,this.emailSelection.clear()},openEmail(e){e.read=!0,this.updateEmail(e),this.openedEmail=e},archiveEmail(e){e.archived=!e.archived,this.updateEmail(e)},async updateEmail(e){const{error:t}=await Q.from("emails").update(e).eq("id",e.id);e.body.replace("Dear","")}}};const le=(0,O.Z)(ie,[["render",k]]);var re=le,ae={name:"App",components:{MailTable:re},setup(){return{emailSelection:$()}}};const oe=(0,O.Z)(ae,[["render",o]]);var ce=oe;(0,i.ri)(ce).mount("#app")}},t={};function n(i){var l=t[i];if(void 0!==l)return l.exports;var r=t[i]={exports:{}};return e[i].call(r.exports,r,r.exports,n),r.exports}n.m=e,function(){var e=[];n.O=function(t,i,l,r){if(!i){var a=1/0;for(u=0;u<e.length;u++){i=e[u][0],l=e[u][1],r=e[u][2];for(var o=!0,c=0;c<i.length;c++)(!1&r||a>=r)&&Object.keys(n.O).every((function(e){return n.O[e](i[c])}))?i.splice(c--,1):(o=!1,r<a&&(a=r));if(o){e.splice(u--,1);var s=l();void 0!==s&&(t=s)}}return t}r=r||0;for(var u=e.length;u>0&&e[u-1][2]>r;u--)e[u]=e[u-1];e[u]=[i,l,r]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){var e,t=Object.getPrototypeOf?function(e){return Object.getPrototypeOf(e)}:function(e){return e.__proto__};n.t=function(i,l){if(1&l&&(i=this(i)),8&l)return i;if("object"===typeof i&&i){if(4&l&&i.__esModule)return i;if(16&l&&"function"===typeof i.then)return i}var r=Object.create(null);n.r(r);var a={};e=e||[null,t({}),t([]),t(t)];for(var o=2&l&&i;"object"==typeof o&&!~e.indexOf(o);o=t(o))Object.getOwnPropertyNames(o).forEach((function(e){a[e]=function(){return i[e]}}));return a["default"]=function(){return i},n.d(r,a),r}}(),function(){n.d=function(e,t){for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})}}(),function(){n.f={},n.e=function(e){return Promise.all(Object.keys(n.f).reduce((function(t,i){return n.f[i](e,t),t}),[]))}}(),function(){n.u=function(e){return"js/"+e+".26920817.js"}}(),function(){n.miniCssF=function(e){}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={},t="simple-mail-client-vue3:";n.l=function(i,l,r,a){if(e[i])e[i].push(l);else{var o,c;if(void 0!==r)for(var s=document.getElementsByTagName("script"),u=0;u<s.length;u++){var d=s[u];if(d.getAttribute("src")==i||d.getAttribute("data-webpack")==t+r){o=d;break}}o||(c=!0,o=document.createElement("script"),o.charset="utf-8",o.timeout=120,n.nc&&o.setAttribute("nonce",n.nc),o.setAttribute("data-webpack",t+r),o.src=i),e[i]=[l];var m=function(t,n){o.onerror=o.onload=null,clearTimeout(f);var l=e[i];if(delete e[i],o.parentNode&&o.parentNode.removeChild(o),l&&l.forEach((function(e){return e(n)})),t)return t(n)},f=setTimeout(m.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=m.bind(null,o.onerror),o.onload=m.bind(null,o.onload),c&&document.head.appendChild(o)}}}(),function(){n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){n.p=""}(),function(){var e={143:0};n.f.j=function(t,i){var l=n.o(e,t)?e[t]:void 0;if(0!==l)if(l)i.push(l[2]);else{var r=new Promise((function(n,i){l=e[t]=[n,i]}));i.push(l[2]=r);var a=n.p+n.u(t),o=new Error,c=function(i){if(n.o(e,t)&&(l=e[t],0!==l&&(e[t]=void 0),l)){var r=i&&("load"===i.type?"missing":i.type),a=i&&i.target&&i.target.src;o.message="Loading chunk "+t+" failed.\n("+r+": "+a+")",o.name="ChunkLoadError",o.type=r,o.request=a,l[1](o)}};n.l(a,c,"chunk-"+t,t)}},n.O.j=function(t){return 0===e[t]};var t=function(t,i){var l,r,a=i[0],o=i[1],c=i[2],s=0;if(a.some((function(t){return 0!==e[t]}))){for(l in o)n.o(o,l)&&(n.m[l]=o[l]);if(c)var u=c(n)}for(t&&t(i);s<a.length;s++)r=a[s],n.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return n.O(u)},i=self["webpackChunksimple_mail_client_vue3"]=self["webpackChunksimple_mail_client_vue3"]||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))}();var i=n.O(void 0,[998],(function(){return n(3848)}));i=n.O(i)})();
//# sourceMappingURL=app.9f9ef9f9.js.map